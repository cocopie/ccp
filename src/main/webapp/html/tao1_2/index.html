<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0, user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="white" />
	<title>响买-用耳朵挑货</title>
	<link rel="stylesheet" href="resources/css/normalize.css" type="text/css" media="screen" title="no title" charset="utf-8"/>
	<link rel="stylesheet" href="resources/lessCss/style.css?v=4" type="text/css" media="screen" title="no title" charset="utf-8"/>
	<script src="resources/js/lib/zepto.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="resources/js/lib/zepto.cookie.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="s.js?id=2&t=aaa" url3rd="http://item.taobao.com/item.htm?id=22581652236&cocopie=v1" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		function sendAjax(step){
			send(step);
		}
	</script>
</head>
<body>
	<h3 class="player_title">桃之11的自用小屋</h3>
	<div class="player_img_box">
		<span class="player_img">
			<img src="resources/images/player.jpg" width="160px" height="160px" alt="" />
		</span>		
	</div>
	<canvas id="myCanvas" height="220px">您的浏览器不支持canvas</canvas>
	<p class="player_name">
		CoCo主播&nbsp;&nbsp;心语
	</p>
	<p class="player_lyc">
		Delinson椰子卸妆油
	</p>
	<div class="player_btn">
		<button id="pause">暂停</button>		
	</div>
	<section class="prodcut">
		<img src="resources/images/product.jpg" alt="" />
		<h3 class="title">
			11用过的最好的卸妆油，去黑头神器
		</h3>
		<div class="info" id="productInfo">
			<span class="price">
				￥<b>160.00</b>
			</span>
			<a href="javascript:void(0);" class="buy_btn">带我回家</a>
		</div>
		<div class="info fixed" id="fixedBuy" style="display:none;">
			<span class="price">
				￥<b>160.00</b>
			</span>
			<a href="javascript:void(0);" class="buy_btn">带我回家</a>
		</div>
		<table id="product_info_table" border="0" cellspacing="5" cellpadding="5">
			<tr>
				<th width="90px;">品牌名称：</th>
				<td>黛兰丝汀（Delinson）</td>
			</tr>
			<tr>
				<th>产品功效：</th>
				<td>去黑头 深层清洁 卸妆 舒缓肌肤</td>
			</tr>
			<tr>
				<th>适用人群：</th>
				<td>任何肤质</td>
			</tr>
			<tr>
				<th>产品容量：</th>
				<td>200g/ml</td>
			</tr>
			<tr>
				<th>生产地区：</th>
				<td>美国</td>
			</tr>
			<tr>
				<th>保质期限：</th>
				<td>3年(具体日期以收到产品为准)</td>
			</tr>
			<tr>
				<th>特别说明：</th>
				<td>美国原装进口，绝对正品，价格也非常白菜</td>
			</tr>
		</table>
		<footer>
			<span>快递：15元</span>
			<span>支持7天无理由退换货</span>
		</footer>
	</section>
	<section id="product_content">
		<img src="resources/images/product_img_1.jpg" alt="" />
		<img src="resources/images/product_img_2.jpg" alt="" />
		<img src="resources/images/product_img_3.jpg" alt="" />
		<img src="resources/images/product_img_4.jpg" alt="" />
		<img src="resources/images/product_img_5.jpg" alt="" />
		<img src="resources/images/product_img_6.jpg" alt="" />
		<img src="resources/images/product_img_7.jpg" alt="" />
		<div class="text_content">
			<b>用法：</b>
			如果白天有涂隔离防晒，那回家先卸妆，然后清水洗掉，晚上洗澡的时候，可以再用一次洁面。如果作为每周定期的深层清洁毛孔用，那就是晚上洁面之后，使用椰子油，打圈按摩，然后清水洗掉即可，不必再用洁面，不要过度清洁皮肤，让皮肤变薄。我个人喜欢卸妆用化妆棉配合，去黑头清洁毛孔直接用手按摩。另外，不要依赖去角质产品，会让皮肤变薄，建议用椰子油替代去角质，专利椰子油可以保护皮肤角质层，所以也不必洗到非常彻底。		
		</div>
	</section>
	<section id="product_reply">
		<header>
			<h3>买家评价</h3>
			<p>Customer Reviews</p>
		</header>
		<div class="reply_list">
			<ul>
				<li>
					<img src="resources/images/reply_ico_1.png" alt="" />
					<dl>
						<dt>不***昕</dt>
						<dd>用了两天才来评价，按11说的每天晚上洗完脸再用这个卸妆油按摩鼻头，我按摩的时间比较长，真的有一小粒一小粒的脏东西被揉出来，但是数量不多，第二天照镜子鼻头明显比前晚要干净，我会一直坚持用的，非常感谢11，东西很好。</dd>
					</dl>
				</li>
				<li>
					<img src="resources/images/reply_ico_2.png" alt="" />
					<dl>
						<dt>r***9</dt>
						<dd>真的会搓出脏东西诶，比贝德玛好用，又不刺激，味道也好问，用33的话说，11确实是神物发现者。</dd>
					</dl>
				</li>
				<li>
					<img src="resources/images/reply_ico_3.png" alt="" />
					<dl>
						<dt>m***9</dt>
						<dd>非常温和，本人不化妆，用来做深层清洁的，用了一次感觉不错，具体效果长期使用后再追评</dd>
					</dl>
				</li>
				<li>
					<img src="resources/images/reply_ico_4.png" alt="" />
					<dl>
						<dt>j***5</dt>
						<dd>叶子味真的很好闻，洁面后特别的清爽，温和还不刺激。大爱</dd>
					</dl>
				</li>
				<li>
					<img src="resources/images/reply_ico_5.png" alt="" />
					<dl>
						<dt>cuizh...</dt>
						<dd>像所有评论中体验的一样，味道很好闻，不太油，按摩很舒服，我严重的黑鼻头没有浮现出颗粒，但是肌肤提亮了，我要继续坚持用，希望我鼻子周围的毛孔变小</dd>
					</dl>
				</li>
			</ul>
		</div>
	</section>
	<div id="go_top">
		<a href="javascript:void(0)">
			<img src="resources/images/top.png" alt="" />
		</a>
	</div>
	<div id="js-fuck-taobao" class="fullscreen-guide fuck-taobao">
	    <span class="js-close-taobao guide-close">×</span>
	    <span class="guide-arrow">&nbsp;</span>
	    <div class="guide-inner">
	        <div class="step step-1">&nbsp;</div>
	        <div class="js-step-2 step step-and-2">&nbsp;</div>
	    </div>
	</div>
	<script><!--
		$(function(){
			$('.reply_list dl').width($(window).width() * 0.9 - 90);
		});
		window.onload = function(){
			//音频设置
			var myAudio = new Audio();
			myAudio.src = "resources/mp3/1.mp3";
			$(myAudio).bind('waiting', function(){
	            $('#pause').css('visibility', 'hidden');
	        });
	        $(myAudio).bind('timeupdate', function(){
	        	$('#pause').css('visibility', 'visible');
	        });
	        var _duration = null;
	        $(myAudio).bind('durationchange', function(){
	        	_duration = myAudio.duration;
	        	console.log(_duration);
	        });
			
			//判断浏览器
			$('.buy_btn').on('click', function(e){
				e.preventDefault();
				var _useragent = navigator.userAgent.toLowerCase();
				if(_useragent.indexOf('micromessenger') > -1){
					if(_useragent.indexOf('iphone') > -1){
						$('#js-fuck-taobao').find('.js-step-2').removeClass('step-and-2').addClass('step-2');
					}
					$('#js-fuck-taobao').show();
				}
				//console.log("带我回家");
				sendAjax(7);
			});
			$('.js-close-taobao').on('click', function(){
				$('#js-fuck-taobao').hide();
			});
	        
	        //动画设置
			var canvas = document.getElementById("myCanvas");
			canvas.width = document.body.clientWidth;
			var ctx = canvas.getContext("2d");
			var W = canvas.width;
			var H = canvas.height;
			var _x = document.body.clientWidth / 2;
			var deg=0,new_deg=0,dif=0;
			var loop,re_loop,step;
			var _w = $('.player_lyc span').width();
			var _step, text_loop;
			var text,text_w;
			var _productFlag, _replyFlag;
			var loading = 0, loading_loop;
			
			function init(){
				ctx.clearRect(0,0,W,H);
				ctx.beginPath();
				ctx.strokeStyle = "rgba(253, 238, 233, 1)";
				ctx.lineWidth=1;
				ctx.arc(_x,110,100,0,Math.PI * 2,false);
				ctx.stroke();
				
				var r = deg*Math.PI/180;
				ctx.beginPath();
				ctx.strokeStyle = "rgba(240, 90, 40, 1)";
				ctx.lineWidth=2;
				ctx.arc(_x,110,100,0-90*Math.PI/180,r-90*Math.PI/180,false);
				ctx.stroke();
				
				
				var x = _x + (100 * Math.cos((deg-90)*Math.PI/180));
				var y = 110 + (100 * Math.sin((deg-90)*Math.PI/180));
				ctx.beginPath();
				ctx.fillStyle = "#f05a28";
				ctx.lineWidth=4;
				ctx.arc(x, y, 4, 0, Math.PI*2, false);					
				
				ctx.fill();
			}
			function draw(){
				new_deg = Math.round(Math.random()*360);
				step = _duration / 360;
				loop = setInterval(to, step * 1000);
			}
			function to(){
				if(deg == 360){
					clearInterval(loop);
				}
				if(deg<=360){
					deg++;
				}else{
					deg = 0;
				}
				init();
			}
			init();
			$(window).resize(function(){
				canvas.width = document.body.clientWidth;
				W = canvas.width;
				_x = document.body.clientWidth / 2;
				_w = $('.player_lyc span').width();
				init();
			});
			function setPos(){
				var _scroll = $(window).scrollTop();
				var _offsetTop =  $('#productInfo').offset().top;
				if(_scroll >= _offsetTop){
					$('#productInfo').css('visibility', 'hidden');
					$('#fixedBuy').show();
					if(!_productFlag){
						//console.log('产品');
						_productFlag = true;
						sendAjax(5);
					}
				}
				if(_scroll < _offsetTop){
					$('#productInfo').css('visibility', 'visible');
					$('#fixedBuy').hide();
				}
			}
			function setGoTop(){
			   var _scroll = $(window).scrollTop();
			   var _w_height = $(window).height();
		       if(_w_height < _scroll){
		           $('#go_top').show();
		       }else{
		           $('#go_top').hide();
		       }
			}
			
			window.goTop = function(acceleration, time) {
				acceleration = acceleration || 0.1;
				time = time || 16;
			 
				var x1 = 0;
				var y1 = 0;
				var x2 = 0;
				var y2 = 0;
				var x3 = 0;
				var y3 = 0;
			 
				if (document.documentElement) {
					x1 = document.documentElement.scrollLeft || 0;
					y1 = document.documentElement.scrollTop || 0;
				}
				if (document.body) {
					x2 = document.body.scrollLeft || 0;
					y2 = document.body.scrollTop || 0;
				}
				var x3 = window.scrollX || 0;
				var y3 = window.scrollY || 0;
			 
				// 滚动条到页面顶部的水平距离
				var x = Math.max(x1, Math.max(x2, x3));
				// 滚动条到页面顶部的垂直距离
				var y = Math.max(y1, Math.max(y2, y3));
			 
				// 滚动距离 = 目前距离 / 速度, 因为距离原来越小, 速度是大于 1 的数, 所以滚动距离会越来越小
				var speed = 1 + acceleration;
				window.scrollTo(Math.floor(x / speed), Math.floor(y / speed));
				
				// 如果距离不为零, 继续调用迭代本函数
				if(x > 0 || y > 0) {
					var invokeFunction = "goTop(" + acceleration + ", " + time + ")";
					window.setTimeout(invokeFunction, time);
				}
			};
			
			$('#go_top').on('click', function(){
				goTop();				
		    });
		    
		    function setReply(){
				var _scroll = $(window).scrollTop();
		    	var _offsetTop = $('#product_reply').offset().top;
				if(_scroll >= _offsetTop){
					if(!_replyFlag){
						//console.log('评论');
						_replyFlag = true;
						sendAjax(6);
					}
				}
		    }

			$(window).scroll(function(){
				setPos();
				setGoTop();
				setReply();
			});
			setPos();
			setGoTop();
			/*
			function loadingAnimate(){
				var _step = 8000 / 3600;
				loading_loop = setInterval(function(){
					if(loading > 360) loading = 0;
					$('.player_img_box').css({
						'-webkit-transform': 'rotate(' + loading + 'deg) translateZ(0)'
					});
					loading += 0.2;		
				}, _step);
			}
			*/
			var loading = 0;
			function loadingAnimate(){
				//var musicTime=48000;
				var musicTime=_duration*1000;//音乐长度
				var loop=musicTime/24;//转动次数,每24ms一次动作
				var b = (musicTime / loop);
				var j=Math.floor((musicTime/(20*1000)))*360;  //大约每20S一圈 j代表总角度
				var a= (j/ loop);
				loading_loop = setInterval(function(){
					//if(loading > 360) loading = 0;
					$('.player_img_box').css({
						'-webkit-transform': 'rotate(' + loading + 'deg) translateZ(0)'
					});
					loading += a;
					//loading=Math.round(loading*100)/100;
				}, b);
			}

	        $('#pause').on('click', function(){
	        	if($(this).hasClass('played')){
	        		$(this).removeClass('played');
	        		myAudio.pause();
	        		clearInterval(loop);
	        		clearInterval(loading_loop);
	        		//console.log('pause');
	        		sendAjax(3);
	        	}else{
	        		myAudio.play();
					$(this).addClass('played');
					$('#pause').css('visibility', 'visible');
					loadingAnimate();
		        	var _draw = setInterval(function(){
						if(_duration !== null){
							clearInterval(_draw);
							draw();
						}
		        	}, 1);
		        	//console.log('play');
		        	sendAjax(2);
	        	}
	        });
	        $(myAudio).bind('ended', function(){
	        	$('#pause').removeClass('played');
	        	clearInterval(loading_loop);
	        	sendAjax(4);
	        });
	        $(myAudio).bind('loadstart', function(){
	        	console.log('loadstart');
	        	sendAjax(9);
	        });
	        $(myAudio).bind('canplaythrough', function(){
	        	console.log('canplaythrough');
	        	sendAjax(10);
	        });
		};
		/*
		var send1=false;
		$(function(){
			if(wx&!send1){
				sendAjax(1);
				send1=true;
			}
		});*/
	--></script>
</body>
</html>